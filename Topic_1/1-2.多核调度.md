# 1-2 多核调度

❓问题 : 内核对进程调度时发送了什么 ?

# 1. 进程调度的本质

## 1.1 **任务** / **进程** 切换

>- **$\color{red}{即 : 上下文切换 , 内核对处理器上执行的进程进行切换}$**
>-  "上下文" 指 : 寄存器的值
>- "上下文切换" 指 : 
>   - 将寄存器的值保存到内存中 (进程被剥夺处理器，停止执行)
>   - 将另一组寄存器的值从内存中加载到寄存器 (调度下一个进程执行)
>
>
><img src="./assets/image-20230828165910401.png" alt="image-20230828165910401" />
>
><img src="./assets/image-20230828170151878.png" alt="image-20230828170151878" />

## 1.2 进程调度的本质

>- 当时间片耗完 , 不管进程正在执行什么代码 , 都一定会发生上下文切换! 
>
><img src="./assets/image-20230828170252166.png" alt="image-20230828170252166" />
>
>- 上下文切换必然导致进程状态的状态
>- 上下文切换由中断触发 (时钟中断 , IO中断 , 等)
>
><img src="./assets/image-20230828172710581.png" alt="image-20230828172710581" />
>
>❓有趣的问题 : 上下文切换时 , 突然收到一个中断会发生什么?
>
>现代操作系统在进行上下文切换之前,一般都会把中断关掉 , 切换完成再把中断打开去响应

## 1.3 详解 Linux 进程状态 ( `ps au` )

><img src="./assets/image-20230828180934796.png" alt="image-20230828180934796" />

## 1.4 编程实验

[[参考链接:null]]()

### 1.4.1 主线程有 `sleep(...)`

><img src="./assets/image-20230829111458402.png" alt="image-20230829111458402" />
>
><img src="./assets/image-20230829111401777.png" alt="image-20230829111401777" />

### 1.4.2 主线程没有 `sleep(...)`

><img src="./assets/image-20230829112347286.png" alt="image-20230829112347286" />
>
><img src="./assets/image-20230829113149224.png" alt="image-20230829113149224" />

### 1.4.3 加入子线程

><img src="./assets/image-20230829114051085.png" alt="image-20230829114051085" />
>
><img src="./assets/image-20230829114748807.png" alt="image-20230829114748807" />

1.4.4 

